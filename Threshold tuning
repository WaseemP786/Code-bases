import numpy as np

thresholds = np.linspace(0.01, 0.99, 99)
best_f1 = 0
best_threshold = 0.5

for t in thresholds:
    y_temp = (y_prob >= t).astype(int)
    f1 = f1_score(y_test, y_temp)
    
    if f1 > best_f1:
        best_f1 = f1
        best_threshold = t

print("\nBest threshold for F1:", round(best_threshold, 3))
print("Best F1:", round(best_f1, 4))
